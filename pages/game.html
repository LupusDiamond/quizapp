<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <meta name="theme-color" content="#5A67D8" />
    <link rel="shortcut icon" href="../src/Logo.png" type="image/x-icon" />
    <link
      href="https://unpkg.com/tailwindcss@^1.0/dist/tailwind.min.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="../style.css" />
    <title>Quiz App | Game</title>
  </head>

  <body class="relative bg-indigo-600 min-h-screen">
    <div class="main w-full h-full p-5 md:px-24 lg:px-56 z-0 absolute">
      <div class="heading flex flex-col items-center justify-center">
        <h1
          class="text-white font-bold text-center my-3 text-5xl md:text-6xl category-text capitalize"
        >
          Whatever
        </h1>
      </div>

      <!-- Question -->

      <div class="bg-white rounded-lg w-full shadow-lg p-4 md:p-12">
        <h2
          class="max-w-lg text-center text-lg md:text-2xl mx-auto font-black text-indigo-900 question-text"
        >
          Q1. Lorem, ipsum dolor sit amet consectetur adipisicing elit. Adipisci
          eum nemo voluptas, doloremque minima commodi?
        </h2>

        <!-- Options -->

        <div
          class="text-lg md:text-xl font-semibold text-indigo-700 max-w-xl mx-auto my-4"
        >
          <div class="block md:flex">
            <div
              onclick="CheckAnswer(1)"
              class="p-3 my-3 mx-2 rounded border-2 border-indigo-300 hover:text-white hover:bg-indigo-500 hover:border-indigo-600 md:w-1/2"
            >
              <a href="#" class="option-a"> A. oooolala </a>
            </div>
            <div
              onclick="CheckAnswer(2)"
              class="p-3 my-3 mx-2 rounded border-2 border-indigo-300 hover:text-white hover:bg-indigo-500 hover:border-indigo-600 md:w-1/2"
            >
              <a href="#" class="option-b"> B. Dos </a>
            </div>
          </div>

          <div class="block md:flex">
            <div
              onclick="CheckAnswer(3)"
              class="p-3 my-3 mx-2 rounded border-2 border-indigo-300 hover:text-white hover:bg-indigo-500 hover:border-indigo-600 md:w-1/2"
            >
              <a href="#" class="option-c"> C. Tres </a>
            </div>
            <div
              onclick="CheckAnswer(4)"
              class="p-3 my-3 mx-2 rounded border-2 border-indigo-300 hover:text-white hover:bg-indigo-500 hover:border-indigo-600 md:w-1/2"
            >
              <a href="#" class="option-d"> D. Balalala llaaa </a>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Popup -->

    <div
      id=""
      class="scale0 absolute bg-transparent t-0 l-0 w-full h-full z-10 mdl"
    >
      <div class="back absolute t-0 l-0 w-full h-full z-20"></div>

      <div
        class="absolute w-full h-full flex items-center justify-center flex-col"
      >
        <div class="bg-white rounded-lg shadow-xl z-30 block big-square">
          <!-- Result -->
          <h1 class="text-center p-24 md:p-56 text-4xl md:text-6xl font-black">
            Correct!
          </h1>
        </div>
        <div
          class="bg-white rounded shadow-xl m-6 z-30 block"
          onclick="closeModal()"
        >
          <!-- Temporary Button -->
          <a
            href="#"
            class="text-center text-indigo-900 p-6 font-semibold text-xl md:text-4xl"
            >Next</a
          >
        </div>
      </div>
    </div>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script>
      /// Category title
      const categorySelected = localStorage.getItem("Category");
      const catText = document.querySelector(".category-text");
      catText.innerHTML = categorySelected;

      /// Modal
      const mdl = document.querySelector(".mdl");
      const bg = document.querySelector(".main");
      function openModal(correct) {
        mdl.querySelector(".big-square").classList.remove("bg-red-500");
        mdl.querySelector(".big-square").classList.remove("bg-green-500");
        mdl.querySelector(".big-square").classList.remove("bg-white");
        if (correct) {
          mdl.querySelector(".big-square").classList.add("bg-green-500");
          mdl.querySelector("h1").innerHTML = "CORRECT!";
          mdl.querySelector("h1").classList.add("text-white");
        } else {
          mdl.querySelector(".big-square").classList.add("bg-red-500");
          mdl.querySelector("h1").innerHTML = "WRONG!";
          mdl.querySelector("h1").classList.add("text-white");
        }

        mdl.id = "scale1";
        bg.classList.add("blur");
      }
      function closeModal() {
        mdl.id = "";
        bg.classList.remove("blur");
        loadNextQuestion();
      }

      /// Questions
      let qObject, catObject, categories, qCategory;
      let questionNumber = 0,
        questionAmount,
        correctIndex;
      let pointsGained;

      $.getJSON("../questions.json", function(json) {
        qObject = json;
      }).done(function() {
        catObject = qObject[Object.keys(qObject)[0]];
        catObject = qObject[Object.keys(qObject)[0]];
        categories = catObject[Object.keys(catObject)[0]];
        switch (categorySelected) {
          case "sports":
            qCategory = categories.sports;
            break;
          case "movies":
            qCategory = categories.movies;
            break;
          case "science":
            qCategory = categories.science;
            break;
          case "literature":
            qCategory = categories.literature;
            break;
          case "history":
            qCategory = categories.history;
            break;
          case "technology":
            qCategory = categories.technology;
            break;
        }

        pointsGained = 0;
        questionAmount = qCategory.length;
        loadNextQuestion();
      });

      function loadNextQuestion() {
        questionNumber++;
        if (questionNumber > questionAmount) {
          loadEndScreen();
        }
        correctIndex = qCategory[questionNumber - 1].correctAnswer;

        // Get question text
        const questionText = document.querySelector(".question-text");
        questionText.innerHTML =
          "Q" +
          questionNumber +
          "." +
          " " +
          qCategory[questionNumber - 1].question;

        // Get answer text
        const answerTexts = document.querySelectorAll("[class^=option]");
        const letters = ["A", "B", "C", "D"];
        for (i = 0; i <= 3; i++) {
          answerTexts[i].innerHTML = "";
          answerTexts[i].innerHTML += letters[i] + ". ";
          answerTexts[i].innerHTML += qCategory[questionNumber - 1].answers[i];
        }
      }
      function CheckAnswer(index) {
        if (index == correctIndex) {
          pointsGained++;
          openModal(true);
        } else {
          openModal(false);
        }
      }

      function loadEndScreen() {
        window.location.href = "./end.html";
        localStorage.setItem("Points", pointsGained);
      }
    </script>
  </body>
</html>
